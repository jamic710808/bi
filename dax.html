<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAX å‡½æ•¸å…¨èƒ½æŸ¥è©¢ç³»çµ±</title>
    <style>
        /* å…¨å±€æ¨£å¼èˆ‡æ¼¸è®ŠèƒŒæ™¯ */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --text-color: #333;
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
            /* éœ€æ±‚2: æ¼¸è®Šè‰²èƒŒæ™¯ */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-color);
        }

        /* ä¸»å®¹å™¨ï¼šè‡ªæˆ‘èª¿æ•´å¤§å° */
        .container {
            width: 90%;
            max-width: 800px;
            background: var(--glass-bg);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin: 20px;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            /* éœ€æ±‚7: éŸ¿æ‡‰å¼ */
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-weight: 700;
        }

        /* åˆ†å€æ¨£å¼ */
        .section-card {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #eee;
        }

        h2 {
            margin-top: 0;
            font-size: 1.2rem;
            color: #4a90e2;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        /* æœç´¢æ¡†æ¨£å¼ */
        .search-box {
            position: relative;
            width: 100%;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* ä¸‹æ‹‰é¸å–® */
        .dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .dropdown-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f5f5f5;
        }

        .dropdown-item:hover {
            background-color: #f0f8ff;
            color: var(--primary-color);
        }

        /* éš¨æ©ŸæŠ½æŸ¥å€åŸŸ */
        .random-display-area {
            text-align: center;
            padding: 20px 0;
        }

        .function-name-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            min-height: 60px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f9f9f9;
            border-radius: 10px;
            border: 2px dashed #ccc;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.3s;
            color: white;
            font-weight: 600;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-start { background-color: #4caf50; }
        .btn-stop { background-color: #f44336; }
        .btn-detail { background-color: #4a90e2; }
        
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* å½ˆçª—æ¨£å¼ (Modal) */
        .modal-overlay {
            display: none; /* é»˜èªéš±è— */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-content {
            background: white;
            width: 100%;
            max-width: 600px;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close-btn:hover { color: #333; }

        .detail-row {
            margin-bottom: 20px;
        }

        .detail-label {
            font-weight: bold;
            color: #555;
            display: block;
            margin-bottom: 5px;
            background: #eef2f7;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
        }

        .detail-text {
            line-height: 1.6;
            color: #444;
            margin-top: 5px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: Consolas, monospace;
            color: #d63384;
        }

        /* æ‰‹æ©Ÿé©é… */
        @media (max-width: 600px) {
            .container {
                width: 95%;
                padding: 15px;
            }
            .function-name-display {
                font-size: 1.8rem;
            }
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }
            .controls {
                flex-direction: column;
            }
        }

        /* é¡¯ç¤º Modal çš„ class */
        .modal-overlay.show {
            display: flex;
            opacity: 1;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>DAX å‡½æ•¸å¯¦é©—å®¤</h1>

    <div class="section-card">
        <h2>ğŸ” å‡½æ•¸æ™ºèƒ½æœç´¢</h2>
        <div class="search-box">
            <input type="text" id="daxSearch" placeholder="è¼¸å…¥ DAX å‡½æ•¸åç¨± (ä¾‹å¦‚: CALCULATE)..." autocomplete="off">
            <div id="dropdown" class="dropdown-list"></div>
        </div>
    </div>

    <div class="section-card">
        <h2>ğŸ² éš¨æ©ŸæŠ½æŸ¥æŒ‘æˆ°</h2>
        <div class="random-display-area">
            <div id="randomName" class="function-name-display">æº–å‚™é–‹å§‹</div>
            <div class="controls">
                <button class="btn btn-start" id="btnStart">é–‹å§‹æ»¾å‹•</button>
                <button class="btn btn-stop" id="btnStop" disabled>æš«åœ</button>
                <button class="btn btn-detail" id="btnDetail" disabled>æŸ¥çœ‹è©³ç´°ä»‹ç´¹</button>
            </div>
        </div>
    </div>
</div>

<div id="modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="modalTitle">Function Name</h3>
            <button class="close-btn" id="modalClose">&times;</button>
        </div>
        <div class="modal-body">
            <div class="detail-row">
                <span class="detail-label">åŠŸèƒ½æè¿°</span>
                <div class="detail-text" id="modalDesc">æè¿°å…§å®¹...</div>
            </div>
            <div class="detail-row">
                <span class="detail-label">èªæ³•</span>
                <div class="detail-text"><code id="modalSyntax">Syntax...</code></div>
            </div>
            <div class="detail-row">
                <span class="detail-label">ä½¿ç”¨å ´æ™¯</span>
                <div class="detail-text" id="modalUsage">å ´æ™¯æè¿°...</div>
            </div>
        </div>
        <div style="text-align: right; margin-top: 20px;">
            <button class="btn" style="background:#666;" onclick="closeModal()">é—œé–‰å½ˆçª—</button>
        </div>
    </div>
</div>

<script>
    /**
     * éœ€æ±‚1: æ”¶éŒ„ DAX å‡½æ•¸è³‡æ–™åº«
     * ç‚ºäº†æ¼”ç¤ºæ•ˆæœï¼Œé€™è£¡æ”¶éŒ„äº†ç´„ 50 å€‹æœ€å¸¸ç”¨çš„æ ¸å¿ƒå‡½æ•¸ã€‚
     * è‹¥éœ€å®Œæ•´æ”¶éŒ„æ‰€æœ‰å‡½æ•¸ï¼Œåªéœ€æŒ‰ç…§æ­¤ JSON æ ¼å¼ç¹¼çºŒæ“´å……å³å¯ã€‚
     */
    const daxFunctions = [
        {
            name: "CALCULATE",
            desc: "åœ¨ä¿®æ”¹å¾Œçš„ç¯©é¸ä¸Šä¸‹æ–‡ä¸­è©•ä¼°è¡¨é”å¼ã€‚",
            syntax: "CALCULATE(<expression>[, <filter1> [, <filter2> [, â€¦]]])",
            usage: "DAX ä¸­æœ€å¼·å¤§çš„å‡½æ•¸ã€‚ç”¨æ–¼å¿½è¦–ç‰¹å®šç¯©é¸å™¨ã€æ–°å¢ç¯©é¸æ¢ä»¶æˆ–é€²è¡Œæ™‚é–“æ™ºæ…§è¨ˆç®—ï¼ˆå¦‚å»å¹´åŒæœŸæ¯”è¼ƒï¼‰ã€‚"
        },
        {
            name: "FILTER",
            desc: "è¿”å›ä¸€å€‹è¡¨ï¼Œè¡¨ç¤ºå¦ä¸€å€‹è¡¨æˆ–è¡¨é”å¼çš„å­é›†ã€‚",
            syntax: "FILTER(<table>,<filter>)",
            usage: "ç”¨æ–¼é«˜ç´šç¯©é¸ï¼Œä¾‹å¦‚ç¯©é¸å‡ºéŠ·å”®é¡å¤§æ–¼ 1000 çš„ç”¢å“è¡¨ï¼Œé€šå¸¸é…åˆ CALCULATE æˆ– COUNTROWS ä½¿ç”¨ã€‚"
        },
        {
            name: "ALL",
            desc: "è¿”å›è¡¨ä¸­çš„æ‰€æœ‰åˆ—æˆ–è¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œä¸¦å¿½ç•¥ä»»ä½•å¯èƒ½å·²æ‡‰ç”¨çš„ç¯©é¸å™¨ã€‚",
            syntax: "ALL( [<table> | <column>[, <column>[, â€¦]]])",
            usage: "ç”¨æ–¼è¨ˆç®—ç¸½è¨ˆç™¾åˆ†æ¯”ï¼ˆåˆ†æ¯éœ€è¦ç§»é™¤ç¯©é¸ï¼‰ï¼Œæˆ–åœ¨ CALCULATE ä¸­æ¸…é™¤ç¯©é¸ä¸Šä¸‹æ–‡ã€‚"
        },
        {
            name: "RELATED",
            desc: "å¾å¦ä¸€å€‹è¡¨è¿”å›ç›¸é—œå€¼ã€‚",
            syntax: "RELATED(<column>)",
            usage: "åœ¨è¨ˆç®—åˆ—ä¸­ä½¿ç”¨ï¼Œé¡ä¼¼ Excel çš„ VLOOKUPã€‚éœ€è¦å…©å€‹è¡¨ä¹‹é–“å·²å»ºç«‹é—œä¿‚ã€‚"
        },
        {
            name: "SUM",
            desc: "å°‡åˆ—ä¸­çš„æ‰€æœ‰æ•¸å­—ç›¸åŠ ã€‚",
            syntax: "SUM(<column>)",
            usage: "æœ€åŸºç¤çš„èšåˆå‡½æ•¸ï¼Œç”¨æ–¼è¨ˆç®—æ•¸å€¼ç¸½å’Œã€‚"
        },
        {
            name: "SUMX",
            desc: "è¿”å›ç‚ºè¡¨ä¸­çš„æ¯ä¸€è¡Œè©•ä¼°è¡¨é”å¼çš„ç¸½å’Œã€‚",
            syntax: "SUMX(<table>, <expression>)",
            usage: "è¿­ä»£å‡½æ•¸ã€‚ä¾‹å¦‚ï¼šSUMX(Sales, Sales[Quantity] * Sales[UnitPrice])ï¼Œé€è¡Œè¨ˆç®—å¾ŒåŠ ç¸½ã€‚"
        },
        {
            name: "AVERAGE",
            desc: "è¿”å›åˆ—ä¸­æ‰€æœ‰æ•¸å­—çš„ç®—è¡“å¹³å‡å€¼ã€‚",
            syntax: "AVERAGE(<column>)",
            usage: "è¨ˆç®—å¹³å‡å€¼ï¼Œæœƒè‡ªå‹•å¿½ç•¥éæ•¸å­—å’Œç©ºå€¼ã€‚"
        },
        {
            name: "DIVIDE",
            desc: "åŸ·è¡Œé™¤æ³•é‹ç®—ï¼Œä¸¦åœ¨é™¤ä»¥ 0 æ™‚è¿”å›æ›¿ä»£çµæœæˆ– BLANK()ã€‚",
            syntax: "DIVIDE(<numerator>, <denominator> [,<alternateresult>])",
            usage: "å®‰å…¨é™¤æ³•ã€‚æ¯”ä½¿ç”¨ '/' é‹ç®—ç¬¦æ›´å¥½ï¼Œå› ç‚ºå®ƒå¯ä»¥å„ªé›…åœ°è™•ç†åˆ†æ¯ç‚º 0 çš„æƒ…æ³ã€‚"
        },
        {
            name: "CALCULATETABLE",
            desc: "åœ¨ä¿®æ”¹å¾Œçš„ç¯©é¸ä¸Šä¸‹æ–‡ä¸­è©•ä¼°è¡¨è¡¨é”å¼ã€‚",
            syntax: "CALCULATETABLE(<expression>[, <filter1> [, <filter2> [, â€¦]]])",
            usage: "èˆ‡ CALCULATE é¡ä¼¼ï¼Œä½†è¿”å›çš„æ˜¯ä¸€å€‹è¡¨è€Œä¸æ˜¯ä¸€å€‹å€¼ã€‚"
        },
        {
            name: "DATEADD",
            desc: "è¿”å›ä¸€å€‹è¡¨ï¼Œå…¶ä¸­åŒ…å«å¾ç•¶å‰ä¸Šä¸‹æ–‡ä¸­çš„æ—¥æœŸå‘æœªä¾†æˆ–éå»ç§»å‹•æŒ‡å®šé–“éš”æ•¸é‡çš„æ—¥æœŸåˆ—ã€‚",
            syntax: "DATEADD(<dates>,<number_of_intervals>,<interval>)",
            usage: "æ™‚é–“æ™ºæ…§å‡½æ•¸ï¼Œç”¨æ–¼è¨ˆç®—å‰ä¸€å€‹æœˆã€æ˜å¹´ç­‰æ•¸æ“šã€‚"
        },
        {
            name: "TOTALYTD",
            desc: "è©•ä¼°ç•¶å‰é¸å®šå¹´ä»½è‡³ä»Šçš„è¡¨é”å¼å€¼ã€‚",
            syntax: "TOTALYTD(<expression>,<dates>[,<filter>][,<year_end_date>])",
            usage: "è¨ˆç®—å¹´åˆè‡³ä»Š (Year-to-Date) çš„ç´¯è¨ˆå€¼ã€‚"
        },
        {
            name: "SAMEPERIODLASTYEAR",
            desc: "è¿”å›ä¸€å€‹è¡¨ï¼Œå…¶ä¸­åŒ…å«ç•¶å‰ä¸Šä¸‹æ–‡ä¸­æŒ‡å®šæ—¥æœŸåˆ—ä¸­æ—¥æœŸçš„ä¸€å¹´å‰çš„ä¸€çµ„æ—¥æœŸã€‚",
            syntax: "SAMEPERIODLASTYEAR(<dates>)",
            usage: "ç”¨æ–¼åŒæ¯”åˆ†æ (YoY)ï¼Œä¾‹å¦‚æ¯”è¼ƒä»Šå¹´ Q1 èˆ‡å»å¹´ Q1 çš„æ¥­ç¸¾ã€‚"
        },
        {
            name: "USERELATIONSHIP",
            desc: "æŒ‡å®šåœ¨ç‰¹å®šè¨ˆç®—ä¸­ä½¿ç”¨çš„ç¾æœ‰é—œä¿‚ã€‚",
            syntax: "USERELATIONSHIP(<columnName1>,<columnName2>)",
            usage: "åœ¨ CALCULATE ä¸­ä½¿ç”¨ï¼Œç”¨æ–¼æ¿€æ´»è™›ç·šé—œä¿‚ï¼ˆéæ´»å‹•é—œä¿‚ï¼‰ï¼Œä¾‹å¦‚æŒ‰ã€Œç™¼è²¨æ—¥æœŸã€è€Œä¸æ˜¯é»˜èªçš„ã€Œè¨‚å–®æ—¥æœŸã€è¨ˆç®—ã€‚"
        },
        {
            name: "DISTINCTCOUNT",
            desc: "è¨ˆç®—åˆ—ä¸­ä¸åŒå€¼çš„æ•¸é‡ã€‚",
            syntax: "DISTINCTCOUNT(<column>)",
            usage: "è¨ˆç®—ä¸é‡è¤‡çš„å®¢æˆ¶æ•¸ã€è¨‚å–®æ•¸ç­‰ã€‚"
        },
        {
            name: "COUNTROWS",
            desc: "è¨ˆç®—æŒ‡å®šè¡¨æˆ–è¡¨é”å¼ä¸­çš„è¡Œæ•¸ã€‚",
            syntax: "COUNTROWS(<table>)",
            usage: "çµ±è¨ˆæ•¸æ“šç­†æ•¸ï¼Œæœ€å¸¸ç”¨æ–¼è¨ˆç®—äº¤æ˜“æ¬¡æ•¸ã€‚"
        },
        {
            name: "SWITCH",
            desc: "æ ¹æ“šå€¼åˆ—è¡¨è©•ä¼°è¡¨é”å¼ä¸¦è¿”å›å¤šå€‹å¯èƒ½çš„çµæœè¡¨é”å¼ä¹‹ä¸€ã€‚",
            syntax: "SWITCH(<expression>, <value>, <result>[, <value>, <result>]â€¦[, <else>])",
            usage: "æ›¿ä»£å¤šå±¤åµŒå¥—çš„ IF èªå¥ï¼Œå¸¸ç”¨æ–¼åˆ†çµ„æˆ–å‹•æ…‹æŒ‡æ¨™é¸æ“‡ã€‚"
        },
        {
            name: "IF",
            desc: "æª¢æŸ¥æ¢ä»¶ï¼Œå¦‚æœç‚º TRUE è¿”å›ä¸€å€‹å€¼ï¼Œå¦å‰‡è¿”å›å¦ä¸€å€‹å€¼ã€‚",
            syntax: "IF(<logical_test>, <value_if_true>[, <value_if_false>])",
            usage: "åŸºç¤é‚è¼¯åˆ¤æ–·ã€‚"
        },
        {
            name: "EARLIER",
            desc: "è¿”å›æåŠçš„åˆ—çš„å¤–éƒ¨è¨ˆç®—å‚³éä¸­è©²åˆ—çš„ç•¶å‰å€¼ã€‚",
            syntax: "EARLIER(<column>, <number>)",
            usage: "è¼ƒèˆŠçš„å‡½æ•¸ï¼Œä¸»è¦ç”¨æ–¼è¨ˆç®—åˆ—ä¸­çš„è¡Œä¸Šä¸‹æ–‡åµŒå¥—ï¼Œç¾åœ¨å¤šç”¨è®Šé‡ (VAR) ä»£æ›¿ã€‚"
        },
        {
            name: "VALUES",
            desc: "è¿”å›å–®åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¾†è‡ªæŒ‡å®šåˆ—çš„éé‡è¤‡å€¼ã€‚",
            syntax: "VALUES(<TableNameOrColumnName>)",
            usage: "ç”¨æ–¼ç²å–ç¯©é¸ä¸Šä¸‹æ–‡ä¸­çš„ç•¶å‰é¸å®šé …ï¼Œæˆ–å°‡åˆ—è½‰æ›ç‚ºè¡¨ã€‚"
        },
        {
            name: "HASONEVALUE",
            desc: "ç•¶ column çš„ä¸Šä¸‹æ–‡å·²è¢«ç¯©é¸ç‚ºåƒ…ä¸€å€‹éé‡è¤‡å€¼æ™‚è¿”å› TRUEã€‚",
            syntax: "HASONEVALUE(<columnName>)",
            usage: "å¸¸ç”¨æ–¼å¡ç‰‡åœ–æˆ–æ¨™é¡Œï¼Œç¢ºä¿åªé¸ä¸­äº†ä¸€å€‹é …ç›®æ™‚æ‰é¡¯ç¤ºç‰¹å®šå…§å®¹ï¼Œå¦å‰‡é¡¯ç¤ºç¸½è¨ˆã€‚"
        },
        {
            name: "SELECTEDVALUE",
            desc: "ç•¶ columnName çš„ä¸Šä¸‹æ–‡å·²è¢«ç¯©é¸ç‚ºåƒ…ä¸€å€‹éé‡è¤‡å€¼æ™‚è¿”å›è©²å€¼ï¼Œå¦å‰‡è¿”å›é»˜èªå€¼ã€‚",
            syntax: "SELECTEDVALUE(<columnName>[, <alternateResult>])",
            usage: "ç²å–åˆ‡ç‰‡å™¨é¸ä¸­çš„å€¼ï¼Œæ˜¯ HASONEVALUE å’Œ VALUES çš„ç°¡åŒ–ç‰ˆã€‚"
        },
        {
            name: "RANKX",
            desc: "è¿”å›è¡¨åˆ—è¡¨ä¸­æ¯è¡Œæ•¸å­—çš„æ’åã€‚",
            syntax: "RANKX(<table>, <expression>[, <value>[, <order>[, <ties>]]])",
            usage: "è¨ˆç®—æ’åï¼Œä¾‹å¦‚éŠ·å”®å“¡æ¥­ç¸¾æ’åã€‚"
        },
        {
            name: "ALLSELECTED",
            desc: "ç²å–è¡¨ç¤ºæŸ¥è©¢ä¸­æ‰€æœ‰è¡Œå’Œåˆ—çš„ä¸Šä¸‹æ–‡ï¼ŒåŒæ™‚ä¿ç•™é¡¯å¼ç¯©é¸å™¨å’Œä¸Šä¸‹æ–‡ï¼ˆåˆ‡ç‰‡å™¨ï¼‰ã€‚",
            syntax: "ALLSELECTED([<tableName> | <columnName>])",
            usage: "ç”¨æ–¼è¨ˆç®—è¦–è¦ºå°è±¡å…§éƒ¨çš„ä½”æ¯”ï¼Œå¿½ç•¥è¦–è¦ºå°è±¡å…§éƒ¨çš„è¡Œç¯©é¸ï¼Œä½†ä¿ç•™å¤–éƒ¨åˆ‡ç‰‡å™¨çš„å½±éŸ¿ã€‚"
        },
        {
            name: "KEEPFILTERS",
            desc: "ä¿®æ”¹ CALCULATE å’Œ CALCULATETABLE å‡½æ•¸åœ¨è©•ä¼°ç¯©é¸å™¨æ™‚æ‡‰ç”¨ç¯©é¸å™¨çš„æ–¹å¼ã€‚",
            syntax: "KEEPFILTERS(<expression>)",
            usage: "ç¢ºä¿ç¯©é¸å™¨æ˜¯ç›¸äº¤è€Œä¸æ˜¯è¦†è“‹ã€‚å¸¸ç”¨æ–¼éœ€è¦ä¿ç•™å¤–éƒ¨ä¸Šä¸‹æ–‡çš„è¤‡é›œè¨ˆç®—ã€‚"
        },
        {
            name: "VAR",
            desc: "å­˜å„²è¡¨é”å¼çš„çµæœä½œç‚ºå‘½åè®Šé‡ã€‚",
            syntax: "VAR <name> = <expression> RETURN <result_expression>",
            usage: "æé«˜ä»£ç¢¼å¯è®€æ€§å’Œæ€§èƒ½ï¼Œé¿å…é‡è¤‡è¨ˆç®—ã€‚"
        },
        {
            name: "LOOKUPVALUE",
            desc: "è¿”å›æ»¿è¶³ä¸€å€‹æˆ–å¤šå€‹æœç´¢æ¢ä»¶çš„è¡Œçš„å€¼ã€‚",
            syntax: "LOOKUPVALUE(<result_columnName>, <search_columnName>, <search_value>[, <search_columnName>, <search_value>]â€¦)",
            usage: "é¡ä¼¼ Excel çš„ VLOOKUPï¼Œä¸éœ€è¦ç‰©ç†é—œä¿‚å³å¯æŸ¥æ‰¾å€¼ã€‚"
        },
        {
            name: "DATESYTD",
            desc: "è¿”å›ä¸€å€‹è¡¨ï¼Œå…¶ä¸­åŒ…å«ç•¶å‰ä¸Šä¸‹æ–‡ä¸­ç•¶å‰å¹´ä»½è‡³ä»Šçš„ä¸€åˆ—æ—¥æœŸã€‚",
            syntax: "DATESYTD(<dates> [,<year_end_date>])",
            usage: "é…åˆ CALCULATE ä½¿ç”¨ï¼Œè¨ˆç®— YTD (Year To Date)ã€‚"
        },
        {
            name: "DATATABLE",
            desc: "æä¾›ä¸€ç¨®æ©Ÿåˆ¶ä¾†è²æ˜å…§è¯å€¼é›†ã€‚",
            syntax: "DATATABLE (ColumnName1, DataType1, ColumnName2, DataType2..., {{Value1, Value2...}, {ValueN, ValueM...}})",
            usage: "æ‰‹å‹•å‰µå»ºéœæ…‹è¡¨ï¼Œå¸¸ç”¨æ–¼è¼”åŠ©è¡¨æˆ–è¨­ç½®æ–·é–‹é€£æ¥çš„åˆ‡ç‰‡å™¨ã€‚"
        },
        {
            name: "FORMAT",
            desc: "å°‡å€¼è½‰æ›ç‚ºæ–‡æœ¬ä¸¦æŒ‰æŒ‡å®šæ ¼å¼é¡¯ç¤ºã€‚",
            syntax: "FORMAT(<value>, <format_string>)",
            usage: "å‹•æ…‹æ¨™é¡Œæˆ–å°‡æ•¸å­—æ ¼å¼åŒ–ç‚ºç‰¹å®šå­—ç¬¦ä¸²ã€‚"
        },
        {
            name: "ISBLANK",
            desc: "æª¢æŸ¥å€¼æ˜¯å¦ç‚ºç©ºï¼Œä¸¦è¿”å› TRUE æˆ– FALSEã€‚",
            syntax: "ISBLANK(<value>)",
            usage: "æ•¸æ“šæ¸…æ´—å’Œæ¢ä»¶åˆ¤æ–·ï¼Œè™•ç†ç¼ºå¤±æ•¸æ“šã€‚"
        }
    ];

    // DOM å…ƒç´ 
    const searchInput = document.getElementById('daxSearch');
    const dropdown = document.getElementById('dropdown');
    const randomDisplay = document.getElementById('randomName');
    const btnStart = document.getElementById('btnStart');
    const btnStop = document.getElementById('btnStop');
    const btnDetail = document.getElementById('btnDetail');
    
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalDesc = document.getElementById('modalDesc');
    const modalSyntax = document.getElementById('modalSyntax');
    const modalUsage = document.getElementById('modalUsage');
    const modalClose = document.getElementById('modalClose');

    // ç‹€æ…‹è®Šé‡
    let intervalId = null;
    let currentRandomFunc = null;

    // --- æœç´¢åŠŸèƒ½é‚è¼¯ ---

    searchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase();
        dropdown.innerHTML = '';
        
        if (!query) {
            dropdown.style.display = 'none';
            return;
        }

        const matches = daxFunctions.filter(f => f.name.toLowerCase().includes(query));

        if (matches.length > 0) {
            matches.forEach(func => {
                const div = document.createElement('div');
                div.className = 'dropdown-item';
                div.textContent = func.name;
                div.onclick = () => {
                    openModal(func);
                    searchInput.value = func.name; // å¯é¸ï¼šé¸ä¸­å¾Œå¡«å……
                    dropdown.style.display = 'none';
                };
                dropdown.appendChild(div);
            });
            dropdown.style.display = 'block';
        } else {
            dropdown.style.display = 'none';
        }
    });

    // é»æ“Šå¤–éƒ¨é—œé–‰ä¸‹æ‹‰èœå–®
    document.addEventListener('click', function(e) {
        if (e.target !== searchInput && e.target !== dropdown) {
            dropdown.style.display = 'none';
        }
    });

    // --- éš¨æ©ŸæŠ½æŸ¥é‚è¼¯ ---

    btnStart.addEventListener('click', () => {
        btnStart.disabled = true;
        btnStop.disabled = false;
        btnDetail.disabled = true;
        
        // å¿«é€Ÿæ»¾å‹•æ•ˆæœ
        intervalId = setInterval(() => {
            const randomIndex = Math.floor(Math.random() * daxFunctions.length);
            randomDisplay.textContent = daxFunctions[randomIndex].name;
        }, 50); // æ¯ 50ms è®Šæ›ä¸€æ¬¡
    });

    btnStop.addEventListener('click', () => {
        clearInterval(intervalId);
        btnStart.disabled = false;
        btnStop.disabled = true;
        btnDetail.disabled = false;

        // é–å®šæœ€çµ‚çµæœ
        const finalName = randomDisplay.textContent;
        currentRandomFunc = daxFunctions.find(f => f.name === finalName);
    });

    btnDetail.addEventListener('click', () => {
        if (currentRandomFunc) {
            openModal(currentRandomFunc);
        }
    });

    // --- å½ˆçª—é‚è¼¯ ---

    function openModal(funcData) {
        modalTitle.textContent = funcData.name;
        modalDesc.textContent = funcData.desc;
        modalSyntax.textContent = funcData.syntax;
        modalUsage.textContent = funcData.usage;
        
        modal.classList.add('show');
    }

    function closeModal() {
        modal.classList.remove('show');
    }

    modalClose.addEventListener('click', closeModal);

    // é»æ“Šé®ç½©å±¤é—œé–‰
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal();
        }
    });

</script>

</body>
</html>