<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ½ï¸ é¸æ“‡å›°é›£çµ‚çµè€…ï¼šé¤å»³åœ°é»è½‰ç›¤</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¨­ç½®å­—é«”ç‚º Inter */
        body { font-family: 'Inter', sans-serif; }
        
        /* è½‰ç›¤å®¹å™¨çš„æ¨£å¼ */
        #wheel-container {
            width: 100%;
            padding-top: 100%; /* 1:1 æ¯”ä¾‹ä½¿å…¶æˆç‚ºæ­£æ–¹å½¢ */
            position: relative;
        }

        /* è½‰ç›¤æœ¬é«”çš„æ¨£å¼ */
        #wheel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: transform 5s cubic-bezier(0.1, 0.7, 0.3, 1.0); /* 5ç§’çš„å¹³æ»‘æ¸›é€Ÿå‹•ç•« */
            background: #fff; /* åˆå§‹èƒŒæ™¯ */
            border: 10px solid #f97316; /* æ©˜è‰²é‚Šæ¡† */
        }
        
        /* è½‰ç›¤é¸é …æ¨™ç±¤çš„æ¨£å¼ */
        .option-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: 0% 0%;
            white-space: nowrap;
            font-size: 0.875rem; /* sm */
            font-weight: bold;
            color: #1f2937; /* ç°è‰²å­—é«” */
            padding: 0.25rem 0.5rem;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
        }

        /* æŒ‡é‡çš„æ¨£å¼ */
        #pointer {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            z-index: 100;
            color: #ef4444; /* ç´…è‰²æŒ‡é‡ */
            font-size: 3rem;
        }
        
        /* æ´»æ½‘çš„æŒ‰éˆ•æ¨£å¼ */
        #spin-button {
            transition: all 0.1s;
        }
        #spin-button:active {
            transform: scale(0.98);
            box-shadow: 0 2px 0 #ea580c;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8">

    <div class="max-w-4xl mx-auto space-y-8">
        
        <!-- æ¨™é¡Œèˆ‡æè¿° -->
        <header class="text-center">
            <h1 class="text-4xl font-extrabold text-gray-800 mb-2">
                ğŸ½ï¸ é¤å»³åœ°é»è½‰ç›¤
            </h1>
            <p class="text-lg text-gray-500">
                è¼¸å…¥æ‚¨çŒ¶è±«ä¸æ±ºçš„é¸é …ï¼Œè®“å‘½é‹æ›¿æ‚¨æ±ºå®šï¼
            </p>
        </header>

        <!-- è¼¸å…¥å€ -->
        <section class="bg-white p-6 rounded-xl shadow-lg border border-gray-200">
            <label for="options-input" class="block text-xl font-semibold text-gray-700 mb-3">
                è¼¸å…¥é¸é … (è«‹ç”¨é€—è™Ÿ `,` åˆ†éš”)
            </label>
            <textarea id="options-input" 
                      rows="4" 
                      class="w-full p-4 border-2 border-orange-300 rounded-lg focus:border-orange-500 focus:ring focus:ring-orange-200 resize-none text-gray-800"
                      placeholder="ä¾‹å¦‚ï¼šæ—¥å¼æ‹‰éºµ, ç¾©å¼æŠ«è–©, éŸ“å¼çƒ¤è‚‰, å°å¼ä¾¿ç•¶, é€Ÿé£Ÿæ¼¢å ¡"></textarea>
            <button id="render-button" 
                    class="mt-4 w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition duration-150">
                æº–å‚™è½‰ç›¤
            </button>
        </section>

        <!-- è½‰ç›¤èˆ‡çµæœå€ -->
        <section class="flex flex-col items-center justify-center space-y-6">
            
            <!-- çµæœé¡¯ç¤º -->
            <div id="result-display" class="min-h-[6rem] flex items-center justify-center text-center">
                <p id="result-text" class="text-2xl sm:text-3xl font-extrabold text-orange-600 opacity-0 transition-opacity duration-500">
                    è«‹å…ˆè¼¸å…¥é¸é …ä¸¦é»æ“Šã€Œæº–å‚™è½‰ç›¤ã€
                </p>
            </div>

            <!-- è½‰ç›¤å®¹å™¨ -->
            <div class="relative w-full max-w-sm sm:max-w-md mx-auto">
                <!-- æŒ‡é‡ (ä½¿ç”¨ SVG ä¾†æ¨¡æ“¬é¤ç›¤/å‰å­) -->
                <div id="pointer">
                    <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <!-- ç°¡åŒ–ç‚ºä¸€å€‹æŒ‡å‘ä¸‹æ–¹çš„é¤å‰åœ–æ¨™ -->
                        <path d="M11 20H13V8H16V6H13V4H11V6H8V8H11V20Z" />
                    </svg>
                </div>
                
                <!-- è½‰ç›¤æœ¬é«” -->
                <div id="wheel-container">
                    <div id="wheel" style="transform: rotate(0deg);">
                        <!-- Sectors and labels generated by JS -->
                    </div>
                </div>
            </div>

            <!-- å•Ÿå‹•æŒ‰éˆ• -->
            <button id="spin-button" 
                    disabled 
                    class="mt-6 px-10 py-4 text-2xl font-black text-white bg-red-600 rounded-full shadow-[0_5px_0_0_#991b1b] hover:bg-red-700 disabled:bg-gray-400 disabled:shadow-none disabled:cursor-not-allowed">
                ä»Šå¤©åƒé€™å€‹ï¼
            </button>
        </section>

    </div>

    <script>
        // DOM å…ƒç´ å¼•ç”¨
        const optionsInput = document.getElementById('options-input');
        const renderButton = document.getElementById('render-button');
        const spinButton = document.getElementById('spin-button');
        const wheel = document.getElementById('wheel');
        const resultText = document.getElementById('result-text');
        
        let options = [];
        let sliceAngle = 0;
        const totalSpins = 8; // ç¢ºä¿æœ‰è¶³å¤ çš„åœˆæ•¸ä¾†æä¾›æˆ²åŠ‡æ•ˆæœ

        // æ´»æ½‘çš„æ‰‡å€é¡è‰²åˆ—è¡¨ (é«˜é£½å’Œåº¦)
        const colors = [
            '#f87171', // Red-400
            '#fbbf24', // Amber-400
            '#34d399', // Emerald-400
            '#60a5fa', // Blue-400
            '#a78bfa', // Violet-400
            '#f472b6', // Pink-400
            '#10b981', // Green-500
            '#f97316', // Orange-600
        ];

        /**
         * 1. æ¸²æŸ“è½‰ç›¤ï¼šæ ¹æ“šè¼¸å…¥é¸é …æ•¸é‡ï¼Œå‹•æ…‹ç”Ÿæˆæ‰‡å€èƒŒæ™¯å’Œé¸é …æ¨™ç±¤
         */
        function renderWheel() {
            const inputVal = optionsInput.value.trim();
            options = inputVal.split(',').map(option => option.trim()).filter(option => option.length > 0);

            if (options.length === 0) {
                wheel.style.background = '#fff';
                wheel.innerHTML = '<div class="absolute inset-0 flex items-center justify-center text-lg font-semibold text-gray-400">è«‹è¼¸å…¥é¸é …</div>';
                resultText.textContent = 'è«‹è¼¸å…¥é¸é …ä¸¦é»æ“Šã€Œæº–å‚™è½‰ç›¤ã€';
                resultText.classList.remove('opacity-100', 'animate-pulse');
                resultText.classList.add('opacity-0');
                spinButton.disabled = true;
                return;
            }

            sliceAngle = 360 / options.length;
            let conicGradientStops = [];
            let labelsHTML = '';
            
            const radius = wheel.offsetWidth / 2;
            const labelDistance = radius * 0.7; // æ¨™ç±¤è·é›¢ä¸­å¿ƒ 70%

            options.forEach((option, index) => {
                const color = colors[index % colors.length];
                const startAngle = index * sliceAngle;
                const endAngle = (index + 1) * sliceAngle;
                
                // å‰µå»º Conic Gradient åœé»
                conicGradientStops.push(`${color} ${startAngle}deg ${endAngle}deg`);

                // è¨ˆç®—æ¨™ç±¤ä½ç½®
                const centerAngle = startAngle + sliceAngle / 2;
                
                // è¨­ç½®æ¨™ç±¤çš„æ—‹è½‰å’Œå¹³ç§»
                // rotate(centerAngle) å°‡æ¨™ç±¤å®šä½åˆ°æ‰‡å€ä¸­å¿ƒ
                // translateY(-labelDistance) å°‡æ¨™ç±¤æ¨åˆ°åœ“å‘¨ä¸Š
                // rotate(90 - centerAngle) å°‡æ–‡å­—æ—‹è½‰ç‚ºè¼ƒæ˜“è®€çš„è§’åº¦ (90åº¦æ˜¯å‚ç›´, æ¸›å»è§’åº¦æŠµæ¶ˆ)
                const transformStyle = `
                    rotate(${centerAngle}deg) 
                    translateY(-${labelDistance}px) 
                    rotate(${90 - centerAngle}deg)
                    translateX(-50%)
                `;

                labelsHTML += `
                    <div class="option-label text-sm sm:text-base p-1 rounded-md bg-white/70 backdrop-blur-sm" style="transform: ${transformStyle};">
                        ${option}
                    </div>
                `;
            });

            // æ‡‰ç”¨ Conic Gradient
            wheel.style.background = `conic-gradient(${conicGradientStops.join(', ')})`;
            
            // æ‡‰ç”¨æ¨™ç±¤
            wheel.innerHTML = labelsHTML;
            
            // é‡ç½®è¼ªç›¤æ—‹è½‰ä¸¦å•Ÿç”¨æŒ‰éˆ•
            wheel.style.transform = 'rotate(0deg)';
            resultText.textContent = `è½‰ç›¤å·²æº–å‚™å°±ç·’ï¼Œå…±æœ‰ ${options.length} å€‹é¸é …ã€‚`;
            resultText.classList.remove('opacity-0');
            resultText.classList.add('opacity-100', 'text-gray-600', 'animate-pulse');
            spinButton.disabled = false;
        }

        /**
         * 2. æ—‹è½‰è½‰ç›¤ï¼šè¨ˆç®—ä¸­çè§’åº¦ï¼Œæ‡‰ç”¨ CSS Transform
         */
        function spinWheel() {
            if (options.length === 0 || spinButton.disabled) return;

            // ç¦ç”¨æŒ‰éˆ•ä¸¦æ¸…é™¤çµæœ
            spinButton.disabled = true;
            resultText.textContent = 'è½‰ç›¤æ­£åœ¨é‹è½‰ä¸­... æ±ºå®šå‘½é‹ï¼';
            resultText.className = 'text-2xl sm:text-3xl font-extrabold text-gray-500 opacity-100';
            wheel.classList.remove('animate-pulse-result');
            
            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç²å‹ç´¢å¼•
            const winningIndex = Math.floor(Math.random() * options.length);
            const winner = options[winningIndex];

            // ä¿®æ­£æ—‹è½‰é‚è¼¯ï¼šç¢ºä¿æŒ‡é‡ç²¾ç¢ºåœ°åœåœ¨ä¸­çæ‰‡å€çš„ã€Œå®‰å…¨ç¯„åœã€å…§ã€‚

            // 1. æ‰‡å€ä¸­å¿ƒè§’åº¦ (å¾é ‚éƒ¨é †æ™‚é‡è¨ˆç®—)
            const centerAngleOfWinner = winningIndex * sliceAngle + sliceAngle / 2;
            
            // 2. æ—‹è½‰é‡ï¼šå°‡æ‰‡å€ä¸­å¿ƒå¸¶åˆ°æŒ‡é‡ä½ç½® (0åº¦è™•)
            const rotationToCenter = 360 - centerAngleOfWinner;
            
            // 3. è¨ˆç®—æœ€å¤§å®‰å…¨åç§»é‡ (è·é›¢ä¸­å¿ƒé»åˆ°é‚Šç·£å†æ¸›å» 5 åº¦çš„ç·©è¡)
            // é¿å…åœåœ¨æ‰‡å€é‚Šç•Œä¸Šé€ æˆè¦–è¦ºæ··æ·†ã€‚
            const maxOffset = sliceAngle / 2 - 5; 
            
            // 4. ç”Ÿæˆä¸€å€‹åœ¨ [-maxOffset, +maxOffset] ä¹‹é–“çš„éš¨æ©Ÿåç§» (å°ç¨±åç§»)
            // ç¢ºä¿æŒ‡é‡åœåœ¨æ‰‡å€çš„ä¸­å¤®éƒ¨åˆ†ã€‚
            const randomOffset = (Math.random() * (2 * maxOffset)) - maxOffset; 
            
            // 5. æœ€çµ‚ç›®æ¨™æ—‹è½‰è§’åº¦ (360åº¦å…§)
            const targetSpinAngle = rotationToCenter + randomOffset;
            
            // 6. ç¸½æ—‹è½‰è§’åº¦ = ç¢ºä¿å¤šåœˆ (æˆ²åŠ‡æ•ˆæœ) + æœ€çµ‚ç›®æ¨™è§’åº¦ (ç²¾ç¢ºåœå®š)
            const finalAngle = (360 * totalSpins) + targetSpinAngle;
            
            // æ‡‰ç”¨æ—‹è½‰
            wheel.style.transition = 'transform 5s cubic-bezier(0.1, 0.7, 0.3, 1.0)';
            wheel.style.transform = `rotate(${finalAngle}deg)`;

            // 3. é¡¯ç¤ºçµæœï¼šå‹•ç•«çµæŸå¾Œ (5ç§’) é¡¯ç¤ºçµæœ
            setTimeout(() => {
                showResult(winner);
            }, 5000); // èˆ‡ CSS transition ä¿æŒä¸€è‡´
        }

        /**
         * 3. é¡¯ç¤ºçµæœï¼šçªå‡ºé¡¯ç¤ºçµæœ
         */
        function showResult(winner) {
            // çªå‡ºé¡¯ç¤ºçµæœæ–‡å­—
            resultText.innerHTML = `å°±æ˜¯å®ƒäº†ï¼š<span class="text-red-600 text-4xl sm:text-5xl">${winner}</span>ï¼`;
            resultText.className = 'text-2xl sm:text-3xl font-extrabold opacity-100 transition-all duration-500';
            
            // çµ¦è½‰ç›¤ä¸€å€‹å¾®å°çš„è„ˆè¡å‹•ç•«æ•ˆæœ
            wheel.style.transition = 'transform 0.5s ease-in-out';
            wheel.style.transform += ' scale(1.02)';

            // æ¢å¾©æ­£å¸¸å°ºå¯¸
            setTimeout(() => {
                wheel.style.transform = wheel.style.transform.replace('scale(1.02)', '');
                spinButton.disabled = false;
                resultText.classList.add('text-orange-600');
            }, 500); 
        }

        /**
         * 4. äº‹ä»¶ç›£è½å™¨
         */
        function setupEventListeners() {
            renderButton.addEventListener('click', renderWheel);
            spinButton.addEventListener('click', spinWheel);

            // åˆå§‹æ¸²æŸ“ä¸€æ¬¡ï¼Œé¡¯ç¤ºæç¤º
            renderWheel();
        }

        // å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼
        setupEventListeners();

    </script>
</body>
</html>